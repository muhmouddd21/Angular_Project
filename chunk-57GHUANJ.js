import{a as A}from"./chunk-6JEOAQEH.js";import{a as k}from"./chunk-QM6DZXPC.js";import{a as x,b as V}from"./chunk-5GY5W4OM.js";import{b as y,d as S,j as q}from"./chunk-SLN674KU.js";import{Ja as v,La as O,Oa as n,Pa as i,Ta as z,Ua as f,Va as b,Xa as r,Ya as g,_ as C,_a as M,db as P,ga as p,ha as m,va as d,wa as u}from"./chunk-RI2LG5KK.js";function E(l,D){if(l&1){let e=z();n(0,"tr")(1,"td"),r(2),i(),n(3,"td"),r(4),i(),n(5,"td"),r(6),i(),n(7,"td"),r(8),i(),n(9,"td")(10,"div",7)(11,"button",8),f("click",function(){let a=p(e).$implicit,o=b();return m(o.requiz(a))}),r(12," Requiz "),i(),n(13,"button",9),f("click",function(){let a=p(e).$implicit,o=b();return m(o.retryWrongAnswers(a))}),r(14," Requiz Wrong "),i(),n(15,"button",10),f("click",function(){let a=p(e).index,o=b();return m(o.deleteQuiz(a))}),r(16," Delete "),i()()()()}if(l&2){let e=D.$implicit;d(2),g(e.topic),d(2),g(e.level),d(2),M(" ",e.numberOfQuestions-e.numberOfWrongAnswers," / ",e.numberOfQuestions," "),d(2),g(e.quizTime)}}var $=(()=>{class l{constructor(e,t,a,o){this.getData=e,this.authService=t,this.quizState=a,this.router=o,this.quizGrades=[],this.email=""}ngOnInit(){this.email=this.authService.email,this.loadUserQuizData()}loadUserQuizData(){this.getData.getRequest(x.concat(`${this.authService.Uid}`),{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.authService.idtoken}`}}).subscribe({next:e=>{let t;if(e instanceof ArrayBuffer){let c=new TextDecoder().decode(e);t=JSON.parse(c)}else t=e;let a=t?.fields?.quizzes?.arrayValue?.values||[];this.quizGrades=a.map(o=>{let c=o.mapValue.fields,_=c.questions?.arrayValue?.values||[],w=c.wrongAnswers?.arrayValue?.values||[];return{topic:c.topic.stringValue,level:c.level.stringValue,numberOfQuestions:_.length,numberOfWrongAnswers:w.length,quizTime:new Date(c.quizTime.timestampValue).toLocaleString(),questions:_.map(s=>({id:s.mapValue.fields.id.stringValue,question:s.mapValue.fields.question.stringValue,options:s.mapValue.fields.options.arrayValue.values.map(h=>h.stringValue),correctAnswer:s.mapValue.fields.correctAnswer.stringValue})),wrongAnswers:w.map(s=>({id:s.mapValue.fields.id.stringValue,question:s.mapValue.fields.question.stringValue,options:s.mapValue.fields.options.arrayValue.values.map(h=>h.stringValue),correctAnswer:s.mapValue.fields.correctAnswer.stringValue})),originalData:o}})},error:e=>{console.error("Error loading quiz data:",e)}})}requiz(e){let t={topic:e.topic,level:e.level,questions:e.questions};this.quizState.setQuiz(t),this.router.navigateByUrl("/questions")}retryWrongAnswers(e){if(e.wrongAnswers.length===0){alert("No wrong answers to retry.");return}let t={topic:e.topic,level:e.level,questions:e.wrongAnswers};this.quizState.setQuiz(t),this.router.navigateByUrl("/questions")}deleteQuiz(e){if(!confirm("Are you sure you want to delete this quiz?"))return;this.quizGrades.splice(e,1);let a={fields:{quizzes:{arrayValue:{values:this.quizGrades.map(o=>o.originalData)}}}};this.getData.patchRequest(x.concat(`${this.authService.Uid}`),a,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.authService.idtoken}`}}).subscribe({next:()=>{console.log("Quiz deleted successfully.")},error:o=>{console.error("Failed to delete quiz:",o)}})}static{this.\u0275fac=function(t){return new(t||l)(u(A),u(V),u(k),u(q))}}static{this.\u0275cmp=C({type:l,selectors:[["app-user"]],standalone:!0,features:[P],decls:26,vars:2,consts:[[1,"dashboard-container"],[1,"header"],[1,"user-info"],[1,"all-grades"],[1,"grades-table-wrapper"],[1,"grades-table"],[4,"ngFor","ngForOf"],[1,"actions"],[1,"requiz-btn",3,"click"],[1,"retry-wrong-btn",3,"click"],[1,"delete-btn",3,"click"]],template:function(t,a){t&1&&(n(0,"div",0)(1,"div",1)(2,"h1"),r(3,"My Quiz Dashboard"),i(),n(4,"div",2)(5,"p"),r(6),i()()(),n(7,"div",3)(8,"h2"),r(9,"All Quiz Grades"),i(),n(10,"div",4)(11,"table",5)(12,"thead")(13,"tr")(14,"th"),r(15,"Quiz Topic"),i(),n(16,"th"),r(17,"Level"),i(),n(18,"th"),r(19,"Score"),i(),n(20,"th"),r(21,"Date"),i(),n(22,"th"),r(23,"Actions"),i()()(),n(24,"tbody"),v(25,E,17,5,"tr",6),i()()()()()),t&2&&(d(6),g(a.email),d(19),O("ngForOf",a.quizGrades))},dependencies:[S,y],styles:['.dashboard-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:20px;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;background-color:#f8fafc;min-height:100vh}.header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:30px;border-radius:12px;margin-bottom:30px;box-shadow:0 4px 20px #667eea4d;display:flex;justify-content:space-between;align-items:center}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:2.5rem;font-weight:700;text-shadow:0 2px 4px rgba(0,0,0,.1)}.user-info[_ngcontent-%COMP%]{background:#ffffff1a;padding:12px 20px;border-radius:50px;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2)}.user-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:1rem;font-weight:500;opacity:.95}.all-grades[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:30px;box-shadow:0 4px 25px #00000014;border:1px solid #e2e8f0}.all-grades[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:25px;font-size:1.8rem;color:#2d3748;font-weight:600;position:relative;padding-bottom:10px}.all-grades[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:0;width:60px;height:3px;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:2px}.grades-table-wrapper[_ngcontent-%COMP%]{overflow-x:auto}.grades-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;border-radius:8px;overflow:hidden;box-shadow:0 2px 15px #0000000f}.grades-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4a5568,#2d3748);color:#fff;text-align:left}.grades-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .grades-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:16px 20px;font-size:.95rem;border-bottom:1px solid #e2e8f0;vertical-align:middle}.grades-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;text-transform:uppercase;letter-spacing:.5px}.grades-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f7fafc}.grades-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(1){font-weight:600;color:#2d3748}.grades-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(2){text-transform:capitalize;color:#667eea;font-weight:600}.grades-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3){font-weight:700;color:#48bb78;font-size:1.1rem}.actions[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap}.requiz-btn[_ngcontent-%COMP%], .retry-wrong-btn[_ngcontent-%COMP%], .delete-btn[_ngcontent-%COMP%]{padding:6px 12px;border:none;border-radius:4px;font-size:.9rem;font-weight:500;cursor:pointer;transition:background-color .3s ease}.requiz-btn[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.requiz-btn[_ngcontent-%COMP%]:hover{background-color:#0056b3}.retry-wrong-btn[_ngcontent-%COMP%]{background-color:#f6ad55;color:#fff}.retry-wrong-btn[_ngcontent-%COMP%]:hover{background-color:#dd6b20}.delete-btn[_ngcontent-%COMP%]{background-color:#e53e3e;color:#fff}.delete-btn[_ngcontent-%COMP%]:hover{background-color:#c53030}']})}}return l})();export{$ as UserComponent};
